import{r as m,j as e}from"./react-56DGgGmo.js";import{c as f}from"./react-dom-Q4NGnn9P.js";import{g as d}from"./graphql-tag-CrpRJWm5.js";import{u as h,m as g,a as p,b as x,A as j,I as y,c as k}from"./@apollo-CsMt0T5v.js";import{u as A,a as b,b as l}from"./react-router-D0mlQqbr.js";import{B as v}from"./react-router-dom-DOvvQv5P.js";import"./scheduler-CzFDRTuY.js";import"./tslib-CsDzdHyo.js";import"./graphql-DuhFgwEb.js";import"./optimism-B-rf95tu.js";import"./@wry-cWkr8o-I.js";import"./zen-observable-ts-CT9n_cjK.js";import"./symbol-observable-DkgX5CMu.js";import"./ts-invariant-x2390lQW.js";import"./rehackt-Ci4na9LI.js";import"./@remix-run-D5RSIWFz.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();const w=d`
  mutation KakaoAuth($code: String!) {
    kakaoAuth(input: { code: $code }) {
      accessToken
      refreshToken
    }
  }
`;function L(){const[n,{loading:r,error:s}]=h(w),i=A(),[t,o]=m.useState("Completing authentication");return m.useEffect(()=>{const u=new URLSearchParams(i.search).get("code");u?n({variables:{code:u}}).then(({data:a})=>{console.log("## data",a),localStorage.setItem("accessToken",a.kakaoAuth.accessToken),localStorage.setItem("refreshToken",a.kakaoAuth.refreshToken),o("Authentication successful. Redirecting..."),setTimeout(()=>{window.location.href="/home"},2e3)}).catch(a=>{console.error("Authentication error:",a),o("Authentication failed. Please try again.")}):o("No authentication code found.")},[n,i]),r?e.jsx("div",{children:"Loading..."}):s?e.jsxs("div",{children:["Error: ",s.message]}):e.jsx(e.Fragment,{children:e.jsx("div",{children:t})})}const K=g("초기값"),O=d`
  query GetKakaoLoginUrl {
    getKakaoLoginUrl {
      url
    }
  }
`;function T(){const{loading:n,error:r,data:s}=p(O),i=x(K);console.log("apollo 전역변수 test ==>",i);const t=()=>{s&&s.getKakaoLoginUrl&&(window.location.href=s.getKakaoLoginUrl.url)};return n?e.jsx("p",{children:"Loading..."}):r?e.jsxs("p",{children:["Error: ",r.message]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-h-full flex-1 flex-col justify-center px-6 py-12 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-sm",children:[e.jsx("img",{alt:"Your Company",src:"https://tailwindui.com/img/logos/mark.svg?color=indigo&shade=600",className:"mx-auto h-10 w-auto"}),e.jsx("h2",{className:"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900",children:"TODOKKAEBI"})]}),e.jsxs("div",{className:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm",children:["투두깨비에 오신 것을 환영합니다!😄",e.jsx("div",{children:e.jsx("button",{type:"submit",className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",onClick:t,children:"KAKAO LOGIN"})})]})]})})}function N(){return e.jsx(e.Fragment,{children:e.jsx("h1",{children:"Home"})})}function E(){return e.jsxs(b,{children:[e.jsx(l,{path:"/",element:e.jsx(T,{})}),e.jsx(l,{path:"/kakao/callback",element:e.jsx(L,{})}),e.jsx(l,{path:"/home",element:e.jsx(N,{})})]})}const P=new j({uri:"http://54.180.61.91:5000/graphql/",cache:new y});f(document.getElementById("root")).render(e.jsx(v,{children:e.jsx(k,{client:P,children:e.jsx(E,{})})}));
